# 03-02. 스위칭 허브의 패킷 중계 동작

> - `성공과 실패를 결정하는 1%의 네트워크 원리`를 참고하였다.



### :bulb: 들어가기 전

- 리피터 허브에 의해 증폭된 신호를 모든 포트에 전달항였다.
- 이제 스위칭 허브는 자신에게 오는 신호인지 판단하고 출력할 포트를 찾고 패킷을 중계한다.



### 스위칭 허브에는 주소 테이블이 존재한다.

- 스위치 내부에는 **MAC 주소와 포트 번호**를 등록한 테이블이 있다.
  - 패킷을 중계할 때 주소 테이블을 보고 어디에 송신할지 판단한다.
- 모든 패킷을 수신하고 버퍼 메모리에 저장한다.
  - 패킷을 버퍼 메모리에 저장하고 수신된 MAC 주소와 일치하는 것이 MAC 주소표에 있는지 조사한다.
  - **스위치 회로**를 통해 패킷을 송신측의 포트에 보낸다.
- 송신측의 포트에 패킷을 보내면 케이블에 신호가 흘러간다.
  - **이더넷의 규칙**에 따라 아무도 송신중이지 않다는 것을 확인하고, 디지털 데이터에서 신호로 변환하여 송신한다.



### 스위칭 허브는 주소 테이블을 등록 & 갱신한다.

- 스위칭 허브는 **MAC 주소를 주소 테이블에 등록한다.**
  - 패킷을 수신했을 때, **송신측 MAC 주소를 조사**하고 이를 수신한 입력 포트 번호와 하나의 세트로 등록한다.
  - 입력 포트 번호 : 송신측 MAC 주소
  - 패킷을 수신할 때마다 위와 같은 등록 동작을 실행한다.
- **오래된 주소는 삭제한다.**
  - 주소 테이블에 등록한 주소 중에 일정 시간이 경과하면 삭제하게 된다.
- 스위칭 허브는 **MAC 주소표**를 자동으로 등록하고 삭제한다.



### 송신과 수신을 동시에 실행

- 송신과 수신을 동시에 실행할 수 있는 것을 **전이중 모드**라고 한다.
  - 리피터 허브에서는 여러 대의 컴퓨터가 동시에 신호를 송신하면 신호가 뒤섞인다.
  - 하지만 스위칭 허브에서는 발생하지 않는다.
- 트위스트 페어 케이블의 신호선은 **송신용과 수신용**으로 나뉘어져있다.
  - 따라서 송신과 수신을 동시에 실행해도 상관없다.
  - 하지만 **이더넷에 신호가 흐르고 있을 때**는 기다렸다가 나중에 송신 동작을 실행한다.
- 여기서, 송신할 때 신호가 흐르고 있어도 기다리지 않고 송신하는 것인 전이중 모드를 만든다.
  - 신호의 충돌을 검출하는 회로를 무효화하고
  - 기다릴 필요가 없기 때문에 반이중 모드보다 빠르게 동작한다.
  - 양방향으로 동시에 송신할 수 있기 때문에 송신할 수 있는 데이터 양의 상한선도 높다.



### 최적의 전송 속도 찾기

- **자동 조정**을 통해 동작 모드와 최적의 전송속도를 찾는다.
  - 기존에는 수동으로 전이중 모드 또는 반이중 모드로 변경을 했다.
  - 하지만 자동 조정은 상대가 어떠한 모드를 지원하는지 검출하고 전송 속도를 검출하여 자동으로 맞춘다.
- 이더넷에는 데이터가 흐르고 있지 않을 때 **링크 펄스**라는 신호가 흐르고 있다.
  - 링크 펄스를 통해 상대가 올바르게 동작하는 지 등을 확인할 수 있는데
  - 링크 펄스를 활용하여 **자신의 상황을 상대에게** 전하는 방법이 생겼다.
  - 지원 가능한 모드, 전송 속도 등을 서로 주고받아 자신을 설정하게 된다.



### 스위칭 허브는 여러 개의 중계 동작을 동시에 실행

- 비어있는 포트가 있기 때문에 동시에 여러 개의 패킷을 중계할 수 있다.
- 하지만 리피터 허브는 들어온 신호를 **모든 포트에서 뿌리기 때문에** 동시에 여러 개의 패킷을 중계할 수 없다.
- 따라서 중계할 수 있는 패킷의 수는 스위칭 허브쪽이 더 많다.